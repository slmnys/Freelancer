{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\suleymanyasar\\\\Desktop\\\\\\xE7al\\u0131\\u015Fmalar\\\\cursor2\\\\frontend\\\\src\\\\components\\\\NotificationBadge.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { Badge, IconButton, Menu, MenuItem, Typography, Box, Divider, Avatar } from '@mui/material';\nimport { Mail as MailIcon } from '@mui/icons-material';\nimport { useNavigate } from 'react-router-dom';\nimport { useSocket } from '../hooks/useSocket';\nimport api from '../utils/axios';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport function NotificationBadge() {\n  _s();\n  const [unreadCount, setUnreadCount] = useState(0);\n  const [messages, setMessages] = useState([]);\n  const [anchorEl, setAnchorEl] = useState(null);\n  const navigate = useNavigate();\n  const socket = useSocket();\n  useEffect(() => {\n    var _socket$current;\n    fetchUnreadMessages();\n\n    // Socket dinleyicileri\n    (_socket$current = socket.current) === null || _socket$current === void 0 ? void 0 : _socket$current.on('newMessage', () => {\n      fetchUnreadMessages();\n    });\n    return () => {\n      var _socket$current2;\n      (_socket$current2 = socket.current) === null || _socket$current2 === void 0 ? void 0 : _socket$current2.off('newMessage');\n    };\n  }, []);\n  const fetchUnreadMessages = async () => {\n    try {\n      const response = await api.get('/messages/unread');\n      setMessages(response.data.data);\n      setUnreadCount(response.data.data.length);\n    } catch (error) {\n      console.error('Okunmamış mesajlar alınamadı:', error);\n    }\n  };\n  const handleClick = event => {\n    setAnchorEl(event.currentTarget);\n  };\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n  const handleMessageClick = async message => {\n    try {\n      // Mesajı okundu olarak işaretle\n      await api.put(`/messages/${message.id}/read`);\n\n      // Projeye git\n      navigate(`/projects/${message.project_id}`);\n      handleClose();\n\n      // Listeyi güncelle\n      fetchUnreadMessages();\n    } catch (error) {\n      console.error('Mesaj işaretlenemedi:', error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(IconButton, {\n      color: \"inherit\",\n      onClick: handleClick,\n      children: /*#__PURE__*/_jsxDEV(Badge, {\n        badgeContent: unreadCount,\n        color: \"error\",\n        children: /*#__PURE__*/_jsxDEV(MailIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Menu, {\n      anchorEl: anchorEl,\n      open: Boolean(anchorEl),\n      onClose: handleClose,\n      PaperProps: {\n        sx: {\n          width: 320,\n          maxHeight: 400\n        }\n      },\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          p: 2\n        },\n        children: /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"h6\",\n          children: \"Mesajlar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this), messages.length === 0 ? /*#__PURE__*/_jsxDEV(MenuItem, {\n        disabled: true,\n        children: /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"body2\",\n          children: \"Yeni mesaj yok\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 11\n      }, this) : messages.map(message => /*#__PURE__*/_jsxDEV(MenuItem, {\n        onClick: () => handleMessageClick(message),\n        sx: {\n          py: 1.5,\n          px: 2,\n          borderBottom: '1px solid',\n          borderColor: 'divider'\n        },\n        children: /*#__PURE__*/_jsxDEV(Box, {\n          sx: {\n            display: 'flex',\n            alignItems: 'flex-start',\n            gap: 1\n          },\n          children: [/*#__PURE__*/_jsxDEV(Avatar, {\n            sx: {\n              width: 32,\n              height: 32\n            },\n            children: message.sender_name[0]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"subtitle2\",\n              children: message.sender_name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 122,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body2\",\n              color: \"text.secondary\",\n              noWrap: true,\n              children: message.content\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 125,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"caption\",\n              color: \"text.secondary\",\n              children: new Date(message.created_at).toLocaleString('tr-TR')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 15\n        }, this)\n      }, message.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 13\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(NotificationBadge, \"RY8sSlID/63pQ2IcI/KUeRjDwBM=\", false, function () {\n  return [useNavigate, useSocket];\n});\n_c = NotificationBadge;\nvar _c;\n$RefreshReg$(_c, \"NotificationBadge\");","map":{"version":3,"names":["React","useState","useEffect","Badge","IconButton","Menu","MenuItem","Typography","Box","Divider","Avatar","Mail","MailIcon","useNavigate","useSocket","api","jsxDEV","_jsxDEV","Fragment","_Fragment","NotificationBadge","_s","unreadCount","setUnreadCount","messages","setMessages","anchorEl","setAnchorEl","navigate","socket","_socket$current","fetchUnreadMessages","current","on","_socket$current2","off","response","get","data","length","error","console","handleClick","event","currentTarget","handleClose","handleMessageClick","message","put","id","project_id","children","color","onClick","badgeContent","fileName","_jsxFileName","lineNumber","columnNumber","open","Boolean","onClose","PaperProps","sx","width","maxHeight","p","variant","disabled","map","py","px","borderBottom","borderColor","display","alignItems","gap","height","sender_name","noWrap","content","Date","created_at","toLocaleString","_c","$RefreshReg$"],"sources":["C:/Users/suleymanyasar/Desktop/çalışmalar/cursor2/frontend/src/components/NotificationBadge.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport {\r\n  Badge,\r\n  IconButton,\r\n  Menu,\r\n  MenuItem,\r\n  Typography,\r\n  Box,\r\n  Divider,\r\n  Avatar\r\n} from '@mui/material';\r\nimport { Mail as MailIcon } from '@mui/icons-material';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useSocket } from '../hooks/useSocket';\r\nimport api from '../utils/axios';\r\n\r\ninterface Message {\r\n  id: string;\r\n  content: string;\r\n  sender_name: string;\r\n  project_id: number;\r\n  created_at: string;\r\n  read: boolean;\r\n}\r\n\r\nexport function NotificationBadge() {\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n  const [messages, setMessages] = useState<Message[]>([]);\r\n  const [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null);\r\n  const navigate = useNavigate();\r\n  const socket = useSocket();\r\n\r\n  useEffect(() => {\r\n    fetchUnreadMessages();\r\n    \r\n    // Socket dinleyicileri\r\n    socket.current?.on('newMessage', () => {\r\n      fetchUnreadMessages();\r\n    });\r\n\r\n    return () => {\r\n      socket.current?.off('newMessage');\r\n    };\r\n  }, []);\r\n\r\n  const fetchUnreadMessages = async () => {\r\n    try {\r\n      const response = await api.get('/messages/unread');\r\n      setMessages(response.data.data);\r\n      setUnreadCount(response.data.data.length);\r\n    } catch (error) {\r\n      console.error('Okunmamış mesajlar alınamadı:', error);\r\n    }\r\n  };\r\n\r\n  const handleClick = (event: React.MouseEvent<HTMLElement>) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  const handleMessageClick = async (message: Message) => {\r\n    try {\r\n      // Mesajı okundu olarak işaretle\r\n      await api.put(`/messages/${message.id}/read`);\r\n      \r\n      // Projeye git\r\n      navigate(`/projects/${message.project_id}`);\r\n      handleClose();\r\n      \r\n      // Listeyi güncelle\r\n      fetchUnreadMessages();\r\n    } catch (error) {\r\n      console.error('Mesaj işaretlenemedi:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <IconButton color=\"inherit\" onClick={handleClick}>\r\n        <Badge badgeContent={unreadCount} color=\"error\">\r\n          <MailIcon />\r\n        </Badge>\r\n      </IconButton>\r\n\r\n      <Menu\r\n        anchorEl={anchorEl}\r\n        open={Boolean(anchorEl)}\r\n        onClose={handleClose}\r\n        PaperProps={{\r\n          sx: { width: 320, maxHeight: 400 }\r\n        }}\r\n      >\r\n        <Box sx={{ p: 2 }}>\r\n          <Typography variant=\"h6\">Mesajlar</Typography>\r\n        </Box>\r\n        <Divider />\r\n        \r\n        {messages.length === 0 ? (\r\n          <MenuItem disabled>\r\n            <Typography variant=\"body2\">Yeni mesaj yok</Typography>\r\n          </MenuItem>\r\n        ) : (\r\n          messages.map((message) => (\r\n            <MenuItem \r\n              key={message.id} \r\n              onClick={() => handleMessageClick(message)}\r\n              sx={{ \r\n                py: 1.5,\r\n                px: 2,\r\n                borderBottom: '1px solid',\r\n                borderColor: 'divider'\r\n              }}\r\n            >\r\n              <Box sx={{ display: 'flex', alignItems: 'flex-start', gap: 1 }}>\r\n                <Avatar sx={{ width: 32, height: 32 }}>\r\n                  {message.sender_name[0]}\r\n                </Avatar>\r\n                <Box>\r\n                  <Typography variant=\"subtitle2\">\r\n                    {message.sender_name}\r\n                  </Typography>\r\n                  <Typography variant=\"body2\" color=\"text.secondary\" noWrap>\r\n                    {message.content}\r\n                  </Typography>\r\n                  <Typography variant=\"caption\" color=\"text.secondary\">\r\n                    {new Date(message.created_at).toLocaleString('tr-TR')}\r\n                  </Typography>\r\n                </Box>\r\n              </Box>\r\n            </MenuItem>\r\n          ))\r\n        )}\r\n      </Menu>\r\n    </>\r\n  );\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}